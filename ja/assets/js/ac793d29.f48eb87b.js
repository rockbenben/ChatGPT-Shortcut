"use strict";(self.webpackChunkchatgpt_shortcut=self.webpackChunkchatgpt_shortcut||[]).push([["650"],{50309(e,r,s){s.d(r,{O:()=>t,c:()=>o});var a=s(74848),i=s(96540),l=s(18049);let o=(0,i.createContext)({userAuth:null,refreshUserAuth:()=>{},setUserAuth:e=>{},authLoading:!1});function t({children:e}){let[r,s]=(0,i.useState)(null),[t,d]=(0,i.useState)(!0),n=(0,i.useCallback)(async()=>{(0,i.startTransition)(()=>d(!0));try{let e=await (0,l.nE)();(0,i.startTransition)(()=>s(e))}catch(e){console.error("Failed to fetch user data:",e)}finally{(0,i.startTransition)(()=>d(!1))}},[]);(0,i.useEffect)(()=>{n()},[]);let c=(0,i.useMemo)(()=>({userAuth:r,setUserAuth:s,refreshUserAuth:n,authLoading:t}),[r,n,t]);return(0,a.jsx)(o.Provider,{value:c,children:e})}},45856(e,r,s){s.r(r),s.d(r,{default:()=>D});var a=s(74848),i=s(96540),l=s(95310),o=s(30568),t=s(21085),d=s(24301),n=s(71024),c=s(35710),h=s(89986),x=s(84073),m=s(47152),u=s(16370),g=s(36813),j=s(71500),p=s(50400),y=s(92228),A=s(78667),w=s(65232),f=s(66845),b=s(63756),T=s(85489),v=s(49776),P=s(76164),k=s(20156),S=s(26385),C=s(56304),I=s(51757),B=s(61381),F=s(50309),z=s(18049);let{Title:E,Text:q}=d.A,R=()=>{let{userAuth:e,refreshUserAuth:r,authLoading:s}=(0,i.useContext)(F.c),{message:d}=n.A.useApp(),{token:R}=c.A.useToken(),[D,L]=(0,i.useState)(!1),[U,G]=(0,i.useState)(!1),[M,$]=(0,i.useState)(""),[H,O]=(0,i.useState)("password"),[_]=h.A.useForm(),[V]=h.A.useForm();(0,i.useEffect)(()=>{e?.data?.username&&$(e.data.username)},[e]),(0,i.useEffect)(()=>{if(!s&&!e){let e=setTimeout(()=>{window.location.href="/"},2e3);return()=>clearTimeout(e)}},[s,e]);let W=async()=>{if(!M.trim())return void d.error("Username cannot be empty");if(M===e?.data.username)return void G(!1);L(!0);try{await (0,z.kZ)(M),(0,z.jI)("username",M),await r(),d.success("Username updated successfully!"),G(!1)}catch(r){console.error("Error updating username:",r);let e=r?.response?.data?.error?.message||"Unknown error";d.error(`Failed to update username: ${e}`)}finally{L(!1)}},Z=async e=>{L(!0);try{await (0,z.ec)(e),d.success((0,a.jsx)(o.A,{id:"message.success.passwordChanged",children:"\u5BC6\u7801\u4FEE\u6539\u6210\u529F\uFF01"})),_.resetFields()}catch(e){console.error("Error changing password:",e),d.error((0,a.jsx)(o.A,{id:"message.error.passwordChangeFailed",children:"\u5BC6\u7801\u4FEE\u6539\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"}))}finally{L(!1)}},J=async e=>{L(!0);try{await (0,z.BD)(e.email),d.success((0,a.jsx)(o.A,{id:"message.success.forgotPassword",children:"\u5BC6\u7801\u91CD\u7F6E\u90AE\u4EF6\u5DF2\u53D1\u9001\uFF01"})),V.resetFields()}catch(e){console.error("Error sending forgot password email:",e),d.error((0,a.jsx)(o.A,{id:"message.error.forgotPassword",children:"\u53D1\u9001\u5BC6\u7801\u91CD\u7F6E\u90AE\u4EF6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"}))}finally{L(!1)}};return s||!e?(0,a.jsx)(t.A,{title:(0,o.T)({id:"link.myAccount",message:"\u6211\u7684\u8D26\u6237"}),children:(0,a.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:(0,a.jsx)(x.A,{size:"large",tip:(0,a.jsx)(o.A,{id:"message.loading",children:"\u52A0\u8F7D\u767B\u5F55\u72B6\u6001..."})})})}):(0,a.jsx)(t.A,{title:(0,o.T)({id:"link.myAccount",message:"\u6211\u7684\u8D26\u6237"}),children:(0,a.jsx)("div",{style:{minHeight:"calc(100vh - 60px)",padding:"24px 0"},children:(0,a.jsx)(m.A,{justify:"center",children:(0,a.jsx)(u.A,{xs:24,sm:22,md:20,lg:16,xl:14,children:(0,a.jsxs)(g.A,{orientation:"vertical",size:"large",style:{width:"100%"},children:[(0,a.jsx)("div",{style:{padding:"16px 24px",background:R.colorBgContainer,borderRadius:R.borderRadiusLG,border:`1px solid ${R.colorBorderSecondary}`,boxShadow:R.boxShadowTertiary},children:(0,a.jsxs)(g.A,{separator:(0,a.jsx)(j.A,{orientation:"vertical"}),children:[(0,a.jsx)(l.A,{to:"/",style:{display:"flex",alignItems:"center",gap:8,color:R.colorTextSecondary},children:(0,a.jsx)(p.Ay,{type:"text",icon:(0,a.jsx)(T.A,{}),style:{paddingLeft:0},children:(0,a.jsx)(o.A,{id:"link.home",children:"\u8FD4\u56DE\u9996\u9875"})})}),(0,a.jsx)(l.A,{to:"/user/center",style:{display:"flex",alignItems:"center",gap:8,color:R.colorTextSecondary},children:(0,a.jsx)(p.Ay,{type:"text",icon:(0,a.jsx)(v.A,{}),children:(0,a.jsx)(o.A,{id:"link.myCenter",children:"\u4E2A\u4EBA\u4E2D\u5FC3"})})})]})}),(0,a.jsxs)(m.A,{gutter:[24,24],children:[(0,a.jsx)(u.A,{xs:24,md:10,children:(0,a.jsx)(y.A,{style:{height:"100%",borderRadius:R.borderRadiusLG,border:`1px solid ${R.colorBorderSecondary}`,boxShadow:R.boxShadowTertiary},title:(0,a.jsxs)(g.A,{children:[(0,a.jsx)(P.A,{style:{color:R.colorPrimary}}),(0,a.jsx)(o.A,{id:"title.userInfo",children:"\u7528\u6237\u4FE1\u606F"})]}),children:(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:24},children:[(0,a.jsx)(A.A,{size:80,icon:(0,a.jsx)(P.A,{}),style:{backgroundColor:R.colorPrimaryBg,color:R.colorPrimary,marginBottom:16}}),U?(0,a.jsxs)(g.A.Compact,{style:{width:"100%",maxWidth:240},children:[(0,a.jsx)(w.A,{value:M,onChange:e=>$(e.target.value),onPressEnter:W,autoFocus:!0}),(0,a.jsx)(p.Ay,{type:"primary",icon:(0,a.jsx)(k.A,{}),onClick:W,loading:D}),(0,a.jsx)(p.Ay,{icon:(0,a.jsx)(S.A,{}),onClick:()=>G(!1)})]}):(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)(E,{level:4,style:{margin:0},children:e.data.username}),(0,a.jsx)(p.Ay,{type:"text",icon:(0,a.jsx)(S.A,{}),onClick:()=>{$(e?.data.username||""),G(!0)},size:"small",style:{color:R.colorTextSecondary}})]}),(0,a.jsx)(q,{type:"secondary",style:{marginTop:4},children:e.data.email}),e.data.userprompts&&e.data.userprompts.filter(e=>e.share).length>0?(0,a.jsxs)(f.A,{color:"green",style:{marginTop:12},children:["\u{1F4DD} ",(0,a.jsx)(o.A,{id:"label.sharedPrompts",children:"\u5DF2\u5206\u4EAB\u63D0\u793A\u8BCD"}),": "+e.data.userprompts.filter(e=>e.share).length]}):(0,a.jsxs)(f.A,{color:"blue",style:{marginTop:12},children:["\u{1F331} ",(0,a.jsx)(o.A,{id:"label.newMember",children:"\u65B0\u6210\u5458\uFF0C\u5F00\u59CB\u5206\u4EAB\u7B2C\u4E00\u4E2A\u63D0\u793A\u8BCD\u5427"})]})]})})}),(0,a.jsx)(u.A,{xs:24,md:14,children:(0,a.jsx)(y.A,{style:{height:"100%",borderRadius:R.borderRadiusLG,border:`1px solid ${R.colorBorderSecondary}`,boxShadow:R.boxShadowTertiary},title:(0,a.jsxs)(g.A,{children:[(0,a.jsx)(C.A,{style:{color:R.colorPrimary}}),(0,a.jsx)(o.A,{id:"title.security",children:"\u5B89\u5168\u8BBE\u7F6E"})]}),extra:(0,a.jsx)(b.A,{value:H,onChange:e=>O(e),options:[{label:(0,a.jsx)(o.A,{id:"action.changePassword",children:"\u4FEE\u6539\u5BC6\u7801"}),value:"password"},{label:(0,a.jsx)(o.A,{id:"action.forgotPassword",children:"\u5FD8\u8BB0\u5BC6\u7801"}),value:"reset"}]}),children:"password"===H?(0,a.jsxs)(h.A,{form:_,onFinish:Z,layout:"vertical",requiredMark:!1,children:[(0,a.jsx)(h.A.Item,{name:"currentPassword",label:(0,a.jsx)(o.A,{id:"placeholder.currentPassword",children:"\u5F53\u524D\u5BC6\u7801"}),rules:[{required:!0,message:(0,o.T)({id:"validation.currentPassword.required",message:"\u8BF7\u8F93\u5165\u5F53\u524D\u5BC6\u7801\uFF01"})}],children:(0,a.jsx)(w.A.Password,{prefix:(0,a.jsx)(I.A,{style:{color:R.colorTextDescription}}),placeholder:(0,o.T)({id:"placeholder.currentPassword",message:"\u5F53\u524D\u5BC6\u7801"}),size:"large"})}),(0,a.jsx)(h.A.Item,{name:"newPassword",label:(0,a.jsx)(o.A,{id:"placeholder.newPassword",children:"\u65B0\u5BC6\u7801"}),rules:[{required:!0,message:(0,o.T)({id:"input.newPassword",message:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801\uFF01"})},{min:6,message:(0,o.T)({id:"validation.password.length",message:"\u5BC6\u7801\u957F\u5EA6\u81F3\u5C11\u4E3A 6 \u4E2A\u5B57\u7B26"})}],children:(0,a.jsx)(w.A.Password,{prefix:(0,a.jsx)(I.A,{style:{color:R.colorTextDescription}}),placeholder:(0,o.T)({id:"placeholder.newPassword",message:"\u65B0\u5BC6\u7801"}),size:"large"})}),(0,a.jsx)(h.A.Item,{name:"confirmPassword",label:(0,a.jsx)(o.A,{id:"placeholder.confirmPassword",children:"\u786E\u8BA4\u65B0\u5BC6\u7801"}),dependencies:["newPassword"],rules:[{required:!0,message:(0,o.T)({id:"validation.confirmPassword.required",message:"\u8BF7\u786E\u8BA4\u65B0\u5BC6\u7801\uFF01"})},({getFieldValue:e})=>({validator:(r,s)=>s&&e("newPassword")!==s?Promise.reject(Error((0,o.T)({id:"validation.password.match",message:"\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4\uFF01"}))):Promise.resolve()})],children:(0,a.jsx)(w.A.Password,{prefix:(0,a.jsx)(I.A,{style:{color:R.colorTextDescription}}),placeholder:(0,o.T)({id:"placeholder.confirmPassword",message:"\u786E\u8BA4\u65B0\u5BC6\u7801"}),size:"large"})}),(0,a.jsx)(h.A.Item,{style:{marginBottom:0},children:(0,a.jsx)(p.Ay,{type:"primary",htmlType:"submit",loading:D,block:!0,size:"large",children:(0,a.jsx)(o.A,{id:"action.changePassword",children:"\u4FEE\u6539\u5BC6\u7801"})})})]}):(0,a.jsxs)(h.A,{form:V,onFinish:J,layout:"vertical",requiredMark:!1,children:[(0,a.jsx)("div",{style:{marginBottom:24,padding:16,background:R.colorFillAlter,borderRadius:R.borderRadiusLG},children:(0,a.jsx)(q,{type:"secondary",children:(0,a.jsx)(o.A,{id:"message.forgotPassword.info",children:"\u5982\u679C\u60A8\u5FD8\u8BB0\u4E86\u5F53\u524D\u5BC6\u7801\uFF0C\u53EF\u4EE5\u901A\u8FC7\u90AE\u7BB1\u91CD\u7F6E\u3002\u6211\u4EEC\u4F1A\u5411\u60A8\u7684\u6CE8\u518C\u90AE\u7BB1\u53D1\u9001\u4E00\u5C01\u5305\u542B\u91CD\u7F6E\u94FE\u63A5\u7684\u90AE\u4EF6\u3002"})})}),(0,a.jsx)(h.A.Item,{name:"email",label:(0,a.jsx)(o.A,{id:"placeholder.email",children:"\u90AE\u7BB1"}),rules:[{required:!0,message:(0,o.T)({id:"validation.email.required",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\uFF01"})},{type:"email",message:(0,o.T)({id:"validation.email.invalid",message:"\u8BF7\u8F93\u5165\u6709\u6548\u7684\u90AE\u7BB1\u5730\u5740\uFF01"})}],initialValue:e?.data?.email||"",children:(0,a.jsx)(w.A,{prefix:(0,a.jsx)(B.A,{style:{color:R.colorTextDescription}}),placeholder:(0,o.T)({id:"placeholder.email",message:"\u90AE\u7BB1"}),size:"large"})}),(0,a.jsx)(h.A.Item,{style:{marginBottom:0},children:(0,a.jsx)(p.Ay,{type:"primary",htmlType:"submit",loading:D,block:!0,size:"large",children:(0,a.jsx)(o.A,{id:"action.sendResetEmail",children:"\u53D1\u9001\u91CD\u7F6E\u90AE\u4EF6"})})})]})})})]})]})})})})})},D=()=>(0,a.jsx)(F.O,{children:(0,a.jsx)(n.A,{children:(0,a.jsx)(R,{})})})}}]);