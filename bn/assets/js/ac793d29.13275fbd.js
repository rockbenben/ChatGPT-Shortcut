"use strict";(self.webpackChunkchatgpt_shortcut=self.webpackChunkchatgpt_shortcut||[]).push([["650"],{58447:function(e,s,r){r.d(s,{O:()=>l,c:()=>n});var a=r(74848),i=r(96540),t=r(61063);let n=(0,i.createContext)({userAuth:null,refreshUserAuth:()=>{},setUserAuth:e=>{},isLoading:!1});function l({children:e}){let[s,r]=(0,i.useState)(null),[l,d]=(0,i.useState)(!0),o=(0,i.useCallback)(async()=>{(0,i.startTransition)(()=>d(!0));try{let e=await (0,t.nE)();(0,i.startTransition)(()=>r(e))}catch(e){console.error("Failed to fetch user data:",e)}finally{(0,i.startTransition)(()=>d(!1))}},[]);(0,i.useEffect)(()=>{o()},[]);let c=(0,i.useMemo)(()=>({userAuth:s,setUserAuth:r,refreshUserAuth:o,isLoading:l}),[s,o,l]);return(0,a.jsx)(n.Provider,{value:c,children:e})}},45856:function(e,s,r){r.r(s),r.d(s,{default:()=>q});var a=r(74848),i=r(96540),t=r(95310),n=r(30568),l=r(21085),d=r(24301),o=r(41081),c=r(84073),m=r(65232),u=r(18495),h=r(36813),g=r(89986),x=r(1559),p=r(47152),j=r(16370),A=r(16629),w=r(36223),f=r(17844),y=r(76164),P=r(20156),T=r(26385),k=r(51757),v=r(61381),b=r(85489),I=r(23485),C=r(58447),E=r(61063);let{Title:F}=d.A,U=()=>{let{userAuth:e,refreshUserAuth:s,isLoading:r}=(0,i.useContext)(C.c),[d,U]=o.Ay.useMessage(),[q,S]=(0,i.useState)(!1),[B,L]=(0,i.useState)(!1),[M,z]=(0,i.useState)("");(0,i.useEffect)(()=>{e?.data?.username&&z(e.data.username)},[e]),(0,i.useEffect)(()=>{if(!r&&!e){let e=setTimeout(()=>{window.location.href="/"},1e3);return()=>clearTimeout(e)}},[e,r]);let N=async()=>{if(!M.trim())return void d.error("Username cannot be empty");if(M===e?.data.username){d.info("No change in username"),L(!1);return}S(!0);try{await (0,E.kZ)(M),(0,E.uz)("username",M),await s(),d.success("Username updated successfully!")}catch(s){console.error("Error updating username:",s);let e=s?.response?.data?.error?.message||"Unknown error";d.error(`Username update failed: ${e}`)}finally{S(!1),L(!1)}},O=async e=>{if(e.newPassword!==e.confirmPassword)return void d.open({type:"error",content:(0,n.T)({id:"input.password.match",message:"\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4\uFF01"}),duration:5});S(!0);try{await (0,E.ec)(e),d.success((0,a.jsx)(n.A,{id:"message.changePassword.success",children:"\u5BC6\u7801\u4FEE\u6539\u6210\u529F\uFF01"}));let s=document.getElementById("changePasswordForm");s&&s.reset()}catch(e){console.error((0,n.T)({id:"error.changePassword",message:"Error changing password:"}),e),d.error((0,a.jsx)(n.A,{id:"message.changePassword.error",children:"\u5BC6\u7801\u4FEE\u6539\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"}))}finally{S(!1)}},_=async e=>{S(!0);try{await (0,E.BD)(e.email),d.success((0,a.jsx)(n.A,{id:"message.forgotPassword.success",children:"\u5BC6\u7801\u91CD\u7F6E\u90AE\u4EF6\u5DF2\u53D1\u9001\uFF01"}));let s=document.getElementById("forgotPasswordForm");s&&s.reset()}catch(e){console.error((0,n.T)({id:"error.forgotPassword",message:"Error sending forgot password email:"}),e),d.error((0,a.jsx)(n.A,{id:"message.forgotPassword.error",children:"\u53D1\u9001\u5BC6\u7801\u91CD\u7F6E\u90AE\u4EF6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"}))}finally{S(!1)}},D=[{required:!0,message:(0,n.T)({id:"input.newPassword",message:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801\uFF01"})},{min:6,message:(0,n.T)({id:"input.password.valid",message:"\u5BC6\u7801\u957F\u5EA6\u81F3\u5C11\u4E3A 6 \u4E2A\u5B57\u7B26"})}];if(r||!e)return(0,a.jsx)(l.A,{title:(0,n.T)({id:"title.userInfo",message:"\u7528\u6237\u4FE1\u606F"}),children:(0,a.jsx)("div",{style:{maxWidth:800,margin:"40px auto",padding:"0 20px",textAlign:"center"},children:(0,a.jsx)(c.A,{size:"large",tip:(0,a.jsx)(n.A,{id:"message.loading.userStatus",children:"\u52A0\u8F7D\u767B\u5F55\u72B6\u6001..."}),role:"status","aria-label":"\u6B63\u5728\u52A0\u8F7D\u7528\u6237\u4FE1\u606F",children:(0,a.jsx)("div",{style:{height:300}})})})});let H=[{key:"1",label:(0,n.T)({id:"userInfo.username",message:"\u7528\u6237\u540D"}),children:(0,a.jsx)("div",{children:B?(0,a.jsx)(m.A,{autoComplete:"off",prefix:(0,a.jsx)(y.A,{}),value:M,onChange:e=>{z(e.target.value)},addonAfter:(0,a.jsx)(u.Ay,{type:"link",icon:(0,a.jsx)(P.A,{}),onClick:N,loading:q})}):(0,a.jsxs)(h.A,{children:[e.data.username,(0,a.jsx)(u.Ay,{type:"link",icon:(0,a.jsx)(T.A,{}),onClick:()=>{z(e?.data.username),L(!0)}})]})})},{key:"2",label:(0,n.T)({id:"userInfo.email",message:"\u90AE\u7BB1"}),children:(0,a.jsx)("div",{children:e.data.email})}],R=[{key:"1",label:(0,n.T)({id:"label.changePassword",message:"\u4FEE\u6539\u5BC6\u7801"}),children:(0,a.jsxs)(g.A,{id:"changePasswordForm",onFinish:O,layout:"vertical",requiredMark:!1,children:[(0,a.jsx)(g.A.Item,{name:"currentPassword",label:(0,a.jsx)(n.A,{id:"placeholder.currentPassword",children:"\u5F53\u524D\u5BC6\u7801"}),rules:[{required:!0,message:(0,n.T)({id:"input.currentPassword",message:"\u8BF7\u8F93\u5165\u5F53\u524D\u5BC6\u7801\uFF01"})}],children:(0,a.jsx)(m.A.Password,{autoComplete:"current-password",prefix:(0,a.jsx)(k.A,{}),placeholder:(0,n.T)({id:"placeholder.currentPassword",message:"\u5F53\u524D\u5BC6\u7801"})})}),(0,a.jsx)(g.A.Item,{name:"newPassword",label:(0,a.jsx)(n.A,{id:"placeholder.newPassword",children:"\u65B0\u5BC6\u7801"}),rules:D,hasFeedback:!0,children:(0,a.jsx)(m.A.Password,{autoComplete:"new-password",prefix:(0,a.jsx)(k.A,{}),placeholder:(0,n.T)({id:"placeholder.newPassword",message:"\u65B0\u5BC6\u7801"})})}),(0,a.jsx)(g.A.Item,{name:"confirmPassword",label:(0,a.jsx)(n.A,{id:"placeholder.confirmPassword",children:"\u786E\u8BA4\u65B0\u5BC6\u7801"}),dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:(0,n.T)({id:"input.confirmPassword",message:"\u8BF7\u786E\u8BA4\u65B0\u5BC6\u7801\uFF01"})},({getFieldValue:e})=>({validator:(s,r)=>r&&e("newPassword")!==r?Promise.reject(Error((0,n.T)({id:"input.password.match",message:"\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4\uFF01"}))):Promise.resolve()})],children:(0,a.jsx)(m.A.Password,{autoComplete:"new-password",prefix:(0,a.jsx)(k.A,{}),placeholder:(0,n.T)({id:"placeholder.confirmPassword",message:"\u786E\u8BA4\u65B0\u5BC6\u7801"})})}),(0,a.jsx)(g.A.Item,{children:(0,a.jsx)(u.Ay,{type:"primary",htmlType:"submit",loading:q,children:(0,a.jsx)(n.A,{id:"button.changePassword",children:"\u4FEE\u6539\u5BC6\u7801"})})})]})},{key:"2",label:(0,n.T)({id:"label.forgotPassword",message:"\u5FD8\u8BB0\u5BC6\u7801"}),children:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{message:(0,a.jsx)(n.A,{id:"message.forgotPassword.info",children:"\u91CD\u7F6E\u5BC6\u7801\u94FE\u63A5\u5C06\u53D1\u9001\u81F3\u60A8\u7684\u90AE\u7BB1"}),type:"info",showIcon:!0,style:{marginBottom:16}}),(0,a.jsxs)(g.A,{id:"forgotPasswordForm",onFinish:_,layout:"vertical",requiredMark:!1,children:[(0,a.jsx)(g.A.Item,{name:"email",label:(0,a.jsx)(n.A,{id:"input.email",children:"\u90AE\u7BB1"}),rules:[{required:!0,message:(0,n.T)({id:"input.email",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1\uFF01"})},{type:"email",message:(0,n.T)({id:"input.email.valid",message:"\u8BF7\u8F93\u5165\u6709\u6548\u7684\u90AE\u7BB1\u5730\u5740\uFF01"})}],initialValue:e?.data?.email||"",children:(0,a.jsx)(m.A,{autoComplete:"email",prefix:(0,a.jsx)(v.A,{}),placeholder:(0,n.T)({id:"placeholder.email",message:"\u90AE\u7BB1"})})}),(0,a.jsx)(g.A.Item,{children:(0,a.jsx)(u.Ay,{type:"primary",htmlType:"submit",loading:q,children:(0,a.jsx)(n.A,{id:"button.sendResetEmail",children:"\u53D1\u9001\u91CD\u7F6E\u90AE\u4EF6"})})})]})]})}];return(0,a.jsxs)(l.A,{title:(0,n.T)({id:"title.userInfo",message:"\u7528\u6237\u4FE1\u606F"}),children:[U,(0,a.jsx)(p.A,{justify:"center",children:(0,a.jsx)(j.A,{xs:24,sm:22,md:20,lg:16,xl:14,children:(0,a.jsxs)("div",{style:{padding:"20px"},children:[(0,a.jsxs)(h.A,{size:"large",style:{marginLeft:8},children:[(0,a.jsxs)(t.A,{to:"/",className:"mainLink",children:[(0,a.jsx)(b.A,{})," ",(0,a.jsx)(n.A,{id:"link.home",children:"\u8FD4\u56DE\u9996\u9875"})]}),(0,a.jsxs)(t.A,{to:"/user/favorite",className:"mainLink",children:[(0,a.jsx)(I.A,{})," ",(0,a.jsx)(n.A,{id:"link.user",children:"\u4E2A\u4EBA\u4E2D\u5FC3"})]})]}),(0,a.jsxs)(A.A,{title:(0,a.jsx)(F,{level:4,style:{marginBottom:0},children:(0,a.jsx)(n.A,{id:"title.userInfo",children:"\u7528\u6237\u4FE1\u606F"})}),style:{marginTop:16},children:[(0,a.jsx)(w.A,{items:H,layout:"vertical"}),(0,a.jsx)(f.A,{type:"card",items:R,destroyOnHidden:!0})]})]})})})]})};function q(){return(0,a.jsx)(C.O,{children:(0,a.jsx)(U,{})})}}}]);