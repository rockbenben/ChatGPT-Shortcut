"use strict";(self.webpackChunkchatgpt_shortcut=self.webpackChunkchatgpt_shortcut||[]).push([["5436"],{50309(e,t,r){r.d(t,{O:()=>l,c:()=>n});var s=r(74848),i=r(96540),a=r(67202),o=r(13462);let n=(0,i.createContext)({userAuth:null,refreshUserAuth:()=>{},setUserAuth:()=>{},authLoading:!1});function l({children:e}){let{getCache:t}=r(55115),l="u">typeof window?t("user_auth"):null,[c,d]=(0,i.useState)(l),u="u">typeof window&&localStorage.getItem("auth_token"),[m,p]=(0,i.useState)(u&&!l),h=(0,i.useCallback)(async(e=!1)=>{if(!("u">typeof window&&localStorage.getItem("auth_token")))return void p(!1);e&&(0,a.clearMySpaceCache)(),e&&(0,i.startTransition)(()=>p(!0));let t=!!l,s=async()=>{let e=await function(e,t,r="operation"){return new Promise((t,s)=>{let i=setTimeout(()=>{s(Error(`[AuthProvider] ${r} timed out after 12000ms`))},12e3);e.then(e=>{clearTimeout(i),t(e)},e=>{clearTimeout(i),s(e)})})}((0,a.xS)(),0,"getMySpace");if(!e)return null;let t=Array.isArray(e.customTags)?e.customTags:e.customTags?.definitions||[],s=(e.items||[]).filter(e=>null!=e.id&&void 0!==e.id||(console.warn("[AuthProvider] Filtered out invalid item with null ID:",e),!1)),n={data:{...e,customTags:t,items:s,favorites:{id:e.favoriteId,loves:(0,o.$W)(s),commLoves:(0,o.VT)(s),customTags:{definitions:t,itemTags:e.customTags?.itemTags||{}}},userprompts:(0,o.Cu)(s)}};(0,i.startTransition)(()=>d(n));let{setCache:l,CACHE_TTL:c}=r(55115);return l("user_auth",n,c.MYSPACE),e};try{await s()}catch(r){if(e)console.error("Failed to fetch user data:",r);else try{await new Promise(e=>setTimeout(e,800)),await s();return}catch(e){console.warn("Failed to fetch user data (after retry):",e)}t||(0,i.startTransition)(()=>d(null))}finally{(0,i.startTransition)(()=>p(!1))}},[]);(0,i.useEffect)(()=>{h()},[]);let f=(0,i.useMemo)(()=>({userAuth:c,setUserAuth:d,refreshUserAuth:h,authLoading:m}),[c,h,m]);return(0,s.jsx)(n.Provider,{value:f,children:e})}},12387(e,t,r){r.d(t,{A:()=>c});var s=r(74848),i=r(96540),a=r(71024),o=r(30568),n=r(50309),l=r(67202);let c=()=>{let{userAuth:e,refreshUserAuth:t}=(0,i.useContext)(n.c),{message:r,modal:c}=a.A.useApp(),d=(0,i.useCallback)(async(e,r,s)=>{await (0,l.O)(r,e,s),await t()},[t]),u=(0,i.useCallback)(async(i,a=!1)=>{try{if(e?.data?.favorites){let t=a?[...e.data.favorites.commLoves||[]]:[...e.data.favorites.loves||[]],r=e.data.favorites.id;t.includes(i)||t.unshift(i),await d(t,r,a)}else await (0,l.vN)([i],a),await t();a&&(0,l.HJ)(i,"upvote").catch(()=>{}),r.success((0,s.jsx)(o.A,{id:"message.addFavorite.success",children:"\u5DF2\u6DFB\u52A0\u5230\u6536\u85CF"}))}catch(t){console.error(t);let e=t?.strapiMessage;e?r.error(e):r.error((0,s.jsx)(o.A,{id:"message.addFavorite.error",children:"\u6536\u85CF\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"}))}},[e,r,d,t]),m=(0,i.useCallback)(async(t,i=!1)=>{try{let a=e?.data?.favorites?.id;if(!a)return void r.error((0,s.jsx)(o.A,{id:"message.removeFavorite.error",children:"\u79FB\u9664\u6536\u85CF\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"}));let n=i?[...e?.data?.favorites?.commLoves||[]]:[...e?.data?.favorites?.loves||[]],l=n.indexOf(t);l>-1&&(n.splice(l,1),i&&localStorage.removeItem(`commus_${t}`),await d(n,a,i),r.success((0,s.jsx)(o.A,{id:"message.removeFavorite.success",children:"\u5DF2\u53D6\u6D88\u6536\u85CF"})))}catch(e){console.error(e),r.error((0,s.jsx)(o.A,{id:"message.removeFavorite.error",children:"\u79FB\u9664\u6536\u85CF\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"}))}},[e,r,d]),p=(0,i.useCallback)((e,t=!1)=>{c.confirm({title:(0,s.jsx)(o.A,{id:"message.removeFavorite.confirm.title",children:"\u53D6\u6D88\u6536\u85CF"}),content:(0,s.jsx)(o.A,{id:"message.removeFavorite.confirm.content",children:"\u786E\u5B9A\u8981\u53D6\u6D88\u6536\u85CF\u8FD9\u4E2A\u63D0\u793A\u8BCD\u5417\uFF1F"}),onOk:async()=>{await m(e,t)},okText:(0,s.jsx)(o.A,{id:"button.confirm",children:"\u786E\u8BA4"}),cancelText:(0,s.jsx)(o.A,{id:"action.cancel",children:"\u53D6\u6D88"}),centered:!0})},[c,m]);return{addFavorite:u,removeFavorite:m,confirmRemoveFavorite:p}}},60438(e,t,r){r.r(t),r.d(t,{default:()=>U});var s=r(74848),i=r(96540),a=r(56347),o=r(71024),n=r(50309),l=r(24301),c=r(47152),d=r(16370),u=r(21751),m=r(42441),p=r(38940),h=r(50400),f=r(52930),y=r(57486),x=r(36813),g=r(71500),v=r(85489),j=r(76164),A=r(83301),w=r(51237),b=r(44022),T=r(16776),k=r(98459),C=r(49346),S=r(7769),F=r(81463),P=r(21085),$=r(95310),z=r(30568),I=r(74831),R=r(12387),E=r(40527),L=r(9643);let M=i.lazy(()=>Promise.all([r.e("4579"),r.e("6119"),r.e("2175")]).then(r.bind(r,55348))),_=i.lazy(()=>r.e("5603").then(r.bind(r,42432))),{Title:D,Text:H}=l.A,N=function({prompt:e,loading:t,error:r,onVote:a}){let{userAuth:N}=(0,i.useContext)(n.c),{message:B}=o.A.useApp(),{copied:O,copyText:U}=(0,I.C)(),{addFavorite:V,confirmRemoveFavorite:q}=(0,R.A)(),J="u">typeof window?window.location.href:"",W=N?.data?.favorites?.commLoves?.includes(e?.id),Y=(0,i.useCallback)(()=>{e?.description&&U(e.description)},[U,e?.description]),K=(0,i.useCallback)(()=>{N?e?.id&&(W?q(e.id,!0):V(e.id,!0)):B.warning((0,z.T)({id:"message.loginRequired",message:"\u8BF7\u5148\u767B\u5F55"}))},[N,e?.id,W,V,q,B]),G=(0,i.useCallback)(t=>{N?e?.id&&a&&a(e.id,t):B.warning((0,z.T)({id:"message.loginRequired",message:"\u8BF7\u5148\u767B\u5F55"}))},[N,e?.id,a,B]);if(t)return(0,s.jsx)(P.A,{title:(0,z.T)({id:"community.loading",message:"\u52A0\u8F7D\u4E2D..."}),children:(0,s.jsx)(c.A,{justify:"center",style:{marginTop:24,marginBottom:24},children:(0,s.jsx)(d.A,{xs:24,sm:22,md:20,lg:18,xl:16,children:(0,s.jsx)(u.A,{variant:"borderless",className:"shadow--md",style:{borderRadius:12},children:(0,s.jsx)(m.A,{active:!0,paragraph:{rows:8}})})})})});if(r||!e)return(0,s.jsx)(P.A,{title:(0,z.T)({id:"community.notFound",message:"\u63D0\u793A\u8BCD\u672A\u627E\u5230"}),children:(0,s.jsx)(c.A,{justify:"center",style:{marginTop:24,marginBottom:24},children:(0,s.jsx)(d.A,{xs:24,sm:22,md:20,lg:18,xl:16,children:(0,s.jsx)(p.Ay,{status:"404",title:(0,z.T)({id:"community.notFound",message:"\u63D0\u793A\u8BCD\u672A\u627E\u5230"}),subTitle:(0,z.T)({id:"community.notFoundDesc",message:"\u8BE5\u63D0\u793A\u8BCD\u53EF\u80FD\u5DF2\u88AB\u5220\u9664\u6216\u8BBE\u4E3A\u79C1\u6709"}),extra:(0,s.jsx)($.A,{to:"/community-prompts",children:(0,s.jsx)(h.Ay,{type:"primary",children:(0,s.jsx)(z.A,{id:"community.backToList",children:"\u8FD4\u56DE\u5217\u8868"})})})})})})});let Q=`${e.title} - ${(0,z.T)({id:"community.seoSuffix",message:"\u793E\u533A\u63D0\u793A\u8BCD"})}`,X=e.remark||e.description?.substring(0,160)||"";return(0,s.jsx)(P.A,{title:Q,description:X,children:(0,s.jsx)(c.A,{justify:"center",style:{marginTop:24,marginBottom:24},children:(0,s.jsx)(d.A,{xs:24,sm:22,md:20,lg:18,xl:16,children:(0,s.jsxs)(f.A,{vertical:!0,gap:"large",style:{minHeight:400},children:[(0,s.jsx)(u.A,{variant:"borderless",className:"shadow--md",style:{borderRadius:12},styles:{body:{padding:24}},children:(0,s.jsxs)(f.A,{vertical:!0,gap:"small",children:[(0,s.jsx)(L.A,{items:[{title:(0,s.jsxs)($.A,{to:"/",style:{color:"var(--ifm-color-primary)"},children:[(0,s.jsx)(v.A,{style:{marginRight:4}}),(0,s.jsx)(z.A,{id:"link.home",children:"\u9996\u9875"})]})},{title:(0,s.jsx)($.A,{to:"/community-prompts",style:{color:"var(--ifm-color-primary)"},children:(0,s.jsx)(z.A,{id:"link.communityPrompts",children:"\u793E\u533A\u63D0\u793A\u8BCD"})})},{title:e.title}],style:{marginBottom:12}}),(0,s.jsxs)(f.A,{justify:"space-between",align:"flex-start",gap:"middle",wrap:"wrap",children:[(0,s.jsx)(D,{level:1,style:{margin:0,fontSize:"1.75rem",lineHeight:1.3},children:e.title}),(0,s.jsxs)(f.A,{gap:12,align:"center",wrap:"wrap",children:[e.owner&&(0,s.jsxs)(H,{type:"secondary",style:{fontSize:14},children:[(0,s.jsx)(j.A,{style:{marginRight:4}}),e.owner]}),(0,s.jsx)(y.A,{value:e.upvoteDifference||0,prefix:(0,s.jsx)(A.A,{style:{color:"var(--ifm-color-danger)"}}),styles:{content:{fontSize:14,color:"var(--ifm-color-emphasis-500)"}}})]})]}),e.remark&&(0,s.jsx)("div",{style:{marginTop:12,borderLeft:"4px solid var(--ifm-color-primary)",paddingLeft:16},children:(0,s.jsx)(l.A.Text,{type:"secondary",style:{fontSize:14},children:e.remark})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[(0,s.jsx)(l.A.Text,{strong:!0,style:{fontSize:16},children:(0,s.jsx)(z.A,{id:"prompt.content",children:"Prompt \u5185\u5BB9"})}),(0,s.jsx)(x.A,{children:(0,s.jsx)(h.Ay,{type:O?"primary":"default",icon:O?(0,s.jsx)(w.A,{}):(0,s.jsx)(b.A,{}),onClick:Y,children:O?(0,s.jsx)(z.A,{id:"message.copied",children:"\u590D\u5236\u6210\u529F"}):(0,s.jsx)(z.A,{id:"action.copy",children:"\u590D\u5236"})})})]}),(0,s.jsx)("div",{style:{backgroundColor:"var(--ifm-color-emphasis-100)",borderRadius:12,padding:24},children:(0,s.jsx)(l.A.Paragraph,{copyable:{text:e.description,tooltips:!1},style:{fontFamily:"'SF Mono', 'Menlo', 'Consolas', 'Courier New', monospace",fontSize:14,lineHeight:1.6,whiteSpace:"pre-wrap",wordBreak:"break-word",color:"var(--ifm-color-content)",margin:0},children:e.description})}),e.notes&&(0,s.jsx)(l.A.Paragraph,{type:"secondary",style:{fontSize:14,lineHeight:1.6,margin:0,marginTop:24},children:e.notes})]}),(0,s.jsx)(g.A,{}),(0,s.jsxs)(f.A,{justify:"space-between",align:"center",wrap:"wrap",gap:"small",children:[(0,s.jsxs)(x.A,{size:"middle",children:[(0,s.jsxs)(h.Ay,{icon:(0,s.jsx)(T.A,{}),onClick:()=>G("upvote"),children:[(0,s.jsx)(z.A,{id:"action.upvote",children:"\u8D5E"})," ",e.upvotes||0]}),(0,s.jsxs)(h.Ay,{icon:(0,s.jsx)(k.A,{}),onClick:()=>G("downvote"),children:[(0,s.jsx)(z.A,{id:"action.downvote",children:"\u8E29"})," ",e.downvotes||0]}),(0,s.jsx)(h.Ay,{icon:W?(0,s.jsx)(C.A,{style:{color:F.bK["5"]}}):(0,s.jsx)(S.A,{}),onClick:K,type:W?"primary":"default",children:W?(0,s.jsx)(z.A,{id:"action.removeFavorite",children:"\u53D6\u6D88\u6536\u85CF"}):(0,s.jsx)(z.A,{id:"common.favorites",children:"\u6536\u85CF"})})]}),(0,s.jsx)(i.Suspense,{fallback:null,children:(0,s.jsx)("div",{className:"social-buttons-grayscale",children:(0,s.jsx)(M,{shareUrl:J,title:`${e.title}: ${e.remark||""}`,popOver:!0})})})]})]})}),(0,s.jsx)(i.Suspense,{fallback:null,children:(0,s.jsx)(_,{type:"transverse"})}),(0,s.jsx)(i.Suspense,{fallback:null,children:(0,s.jsx)(u.A,{variant:"borderless",className:"shadow--md",style:{minHeight:480,borderRadius:12},children:(0,s.jsx)(E.A,{pageId:e.id,type:"userprompt"})})})]})})})})};var B=r(67202);function O(){let e=(0,a.zy)(),{message:t}=o.A.useApp(),{userAuth:r}=(0,i.useContext)(n.c),[l,c]=(0,i.useState)(null),[d,u]=(0,i.useState)(!0),[m,p]=(0,i.useState)(null),h=i.useMemo(()=>{let t=new URLSearchParams(e.search).get("id");if(t){let e=parseInt(t,10);return Number.isInteger(e)&&e>0?e:null}return null},[e.search]);(0,i.useEffect)(()=>{if(!h){p(Error("Invalid prompt ID")),u(!1);return}(async()=>{u(!0),p(null);try{let e=await (0,B.F6)(h);e?c(e):p(Error("Prompt not found"))}catch(e){p(e instanceof Error?e:Error("Failed to fetch prompt"))}finally{u(!1)}})()},[h]);let f=(0,i.useRef)(new Set),y=(0,i.useCallback)(async(e,s)=>{if(!r)return void t.warning("Please log in to vote.");let i=`${e}_${s}`;if(f.current.has(i))return void t.info(`You have already ${s}d this prompt in this session.`);f.current.add(i),l&&l.id===e&&c({...l,upvotes:"upvote"===s?(l.upvotes||0)+1:l.upvotes,downvotes:"downvote"===s?(l.downvotes||0)+1:l.downvotes,upvoteDifference:(l.upvoteDifference||0)+("upvote"===s?1:-1)});try{let r=await (0,B.HJ)(e,s);if(r?.data?.counts&&l){let{upvotes:e,downvotes:t}=r.data.counts;c({...l,upvotes:e,downvotes:t,upvoteDifference:e-t})}t.success(`Successfully ${s}d!`)}catch(r){f.current.delete(i),l&&c(l);let e=r?.strapiMessage||`Failed to ${s}. Please try again.`;t.error(e)}},[l,t,r]);return(0,s.jsx)(N,{prompt:l,loading:d,error:m,onVote:y})}function U(){return(0,s.jsx)(n.O,{children:(0,s.jsx)(O,{})})}},13462(e,t,r){function s(e){return e.filter(e=>"favorite"===e.type&&"card"===e.source).map(e=>e.id)}function i(e){return e.filter(e=>"favorite"===e.type&&"community"===e.source).map(e=>e.id)}function a(e){return e.filter(e=>"prompt"===e.type&&"userprompt"===e.source).map(e=>({id:e.id,share:e.share??!1,updatedAt:e.updatedAt}))}r.d(t,{$W:()=>s,Cu:()=>a,VT:()=>i})}}]);